<!DOCTYPE html>
<html lang="en">


    <head>

        <title>DataVisualisations</title>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.1/styles/a11y-dark.min.css" integrity="sha512-1rzCaYWsg3l6uKvGbUT6rAZFOcVn0zeXAFlZudsnj8k2xcrU5asL8jfJUEijV9GPYMh0GnPToeCTJj6RXQnA8g==" crossorigin="anonymous" />
        <link rel="stylesheet" href="../../../css/colors.css" type="text/css">
        <link rel="stylesheet" href="../../../css/main.css" type="text/css">

        <script src="https://kit.fontawesome.com/4ebb081c7a.js" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" defer integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" defer integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.1/highlight.min.js" integrity="sha512-d00ajEME7cZhepRqSIVsQVGDJBdZlfHyQLNC6tZXYKTG7iwcF8nhlFuppanz8hYgXr8VvlfKh4gLC25ud3c90A==" crossorigin="anonymous"></script>
        <script>window.hljs.highlightAll();</script>
    </head>




    <body>

        <!-- nav bar start  -->


        <nav class="navbar navbar-expand-lg ml-auto navbar-dark bg-primary">

            <a class="navbar-brand" href="/">
                <img src="../../../image/logo.svg" width="30" height="30" class="d-inline-block align-top" alt="logo">
                DataVisualisations
            </a>

            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse " id="navbarNavDropdown">
                <ul class="navbar-nav ml-auto">

                    <li class="nav-item">
                        <a class="nav-link" href="../../../pages/visualizations/earthquake/">Earthquake Data</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="../../../pages/visualizations/exchange/">Exchange Rate</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="../../../pages/visualizations/iss/">ISS Track</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="../../../pages/visualizations/marketcap/">Coin Race</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="../../../pages/visualizations/quality/">Life Quality</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="../../../pages/visualizations/weather/">Weather Data</a>
                    </li>


                    <li class="nav-item dropdown active">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Tutorials
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                            <a class="dropdown-item" href="../../../pages/tutorials/earthquake/">Earthquake Data Tutorial</a>
                            <a class="dropdown-item" href="../../../pages/tutorials/exchange/">Exchange Rate Tutorial</a>
                            <a class="dropdown-item" href="../../../pages/tutorials/iss/">ISS Track Tutorial</a>
                            <a class="dropdown-item" href="../../../pages/tutorials/marketcap/">Coin Race Tutorial</a>
                            <a class="dropdown-item" href="../../../pages/tutorials/quality/">Life Quality Tutorial</a>
                            <a class="dropdown-item" href="../../../pages/tutorials/weather/">Weather Data Tutorial</a>
                        </div>
                    </li>
                </ul>


            </div>


        </nav>

        <!-- nav bar end  -->





        <div class="container-fluid layout-container-fluid rounded"> <!-- layout-container-fluid -->


            <div class="row no-gutters">  <!-- Row 1  -->


                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12"> <!-- col 1  -->

                    <div class="content-container-fluid">
                        <div class="card text-white bg-primary">
                            <div class="card-header"><i class="fas fa-graduation-cap"></i> Tutorial for Marketcap</div>
                            <div class="card-body">






                                <!-- Page content start  -->

                                <div class="container-fluid">

                                    <div class="row no-gutters">  <!-- Row   -->


                                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6"> <!-- col   -->

                                            <div class="container-fluid">


                                                <h5 class="card-title">Tutorial Sections</h5>

                                                <ol>
                                                    <li>Getting the data from the API</li>
                                                    <li>Processing the information</li>
                                                    <li>Displaying in the visualisation</li>
                                                    <li>Further reading links</li>
                                                </ol>


                                            </div>

                                        </div>  <!-- col 1  -->


                                        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 col-xl-6"> <!-- col 2  -->

                                            <div class="container-fluid">

                                                <img src="./image.png" class="rounded w-100" alt="Computer code">


                                            </div>

                                        </div> <!-- col 2  -->


                                    </div> <!-- Row   -->

                                </div>









                                <div class="divider my-4"></div>



                                <h5 class="card-title"><i class="fas fa-cloud-download-alt"></i> Getting the data from the API</h5>

                                <p class="card-text">
                                    The CoinGecko API is utilised to fetch data in marketcap barchart race visualization. This API is an excellent choice for cryptocurrencies as the data comes from one of the most popular price trackers and requires no API key to function.
                                </p>

                                <p class="card-text">
                                    There are many ways to get the data from the api but the most up to date best practice is to use the JavaScript Fetch API introduced in es6.
                                </p>

                                <pre><code class="javascript">
static async #fetchCoinNames()
{
    const urlText = `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=50&page=1&sparkline=false`;
    const response = await fetch(urlText);
    const data = await response.json();

    const coinNames = data.map(coin => coin.id);

    let coinsNamesToFilter = ["bitcoin", "ethereum", "ripple", "tether", "usd-coin"];
    let filteredCoinNames = coinNames.filter(name => !(coinsNamesToFilter.includes(name)));
    let shortListTokenNames = filteredCoinNames.slice(0, 15);

    return shortListTokenNames
}
                                </code></pre>

                                <div class="divider my-4"></div>





                                <h5 class="card-title"><i class="fas fa-wrench"></i> Processing the information</h5>

                                <p class="card-text">
                                    The data taken from the CoinGecko AP will not be suitable as it is and will need to be processed in a number of steps.
                                </p>

                                <p class="card-text">
                                    First the names of the 50 largest market caps will need to be requested. As there is a large discrepancy between the largest few coins and the remaining of the top 50 you may wish to filter these to provide a more useful bar chart race that can show changes over time.
                                </p>

                                <p class="card-text">
                                    The next step is the loop through the array of the largest market caps and make new requests for each coin name in order to get the chart history for each coin in the desired time frame.
                                </p>

                                <p class="card-text">
                                    Finally the data will need to be parsed into a format the bar chart race will understand. This can be done by iterating through the collected data and creating an array of object literals in a data, name, category and value format.
                                </p>

                                <pre><code class="javascript">
static async #fetchCoinMarketcap(coinText)
{
    const urlText = `https://api.coingecko.com/api/v3/coins/${coinText}/market_chart?vs_currency=usd&days=90&interval=daily`;
    const response = await fetch(urlText);
    const data = await response.json();
    const allMarketCaps = data.market_caps;
    let fullDataObjectArray = [];


    for (const [key, value] of Object.entries(allMarketCaps))
    {

        fullDataObjectArray.push(
            {
                date: new Date(value[0]),
                name: coinText,
                category: coinText,
                value: value[1].toFixed(2)
            }
        );

    }

    return fullDataObjectArray;
}
                                </code></pre>

                                <div class="divider my-4"></div>






                                <h5 class="card-title"><i class="fas fa-desktop"></i> Displaying in the visualisation</h5>

                                <p class="card-text">
                                    The chart consists of four main parts; the bars, the x-axis, the labels, and the ticker showing the current date. These are updated on a continuous loop at and rate defined by the key frame rate until the data has been completely iterated though.
                                </p>

                                <p class="card-text">
                                    The bars displayed on screen are defined by a rank depended by the top 15 caps out of 50. The x-asis is updated on the same keyframe using the date from the value property of the objects created earlier. The labels are static from the name property and the ticker from the date property.
                                </p>

                                <pre><code class="javascript">
let barChartSvg = d3.select("#barChartSvg").attr("viewBox", [0, 0, width, height]);

let updateBars = bars(barChartSvg);
let updateAxis = axis(barChartSvg);
let updateLabels = labels(barChartSvg);
let updateTicker = ticker(barChartSvg);


document.getElementById("loadingP").remove(); //Turn off loading text
for (const keyframe of keyframes)
{
    const transition = barChartSvg.transition().duration(duration).ease(d3.easeLinear);

    // Extract the top bar’s value.
    xHorizontal.domain([0, keyframe[1][0].value]);

    updateAxis(keyframe, transition);
    updateBars(keyframe, transition);
    updateLabels(keyframe, transition);
    updateTicker(keyframe, transition);

    await transition.end();
}
                                </code></pre>

                                <div class="divider my-4"></div>






                                <h5 class="card-title"><i class="fas fa-book-reader"></i> Further Reading links</h5>

                                <ul>
                                    <li><a href="https://www.coingecko.com/en/api#explore-api" target="_blank" class="text-decoration-none font-weight-bold text-white"><i class="fas fa-link"></i> CoinGecko API Documentation</a></li>
                                    <li><a href="https://www.w3schools.com/js/js_api_fetch.asp" target="_blank" class="text-decoration-none font-weight-bold text-white"><i class="fas fa-link"></i> W3 Schools - JavaScript Fetch API</a></li>
                                    <li><a href="https://github.com/d3/d3/wiki" target="_blank" class="text-decoration-none font-weight-bold text-white"><i class="fas fa-link"></i> D3 Library Documentation </a></li>
                                </ul>

                                <div class="divider my-4"></div>




                                <!-- Page content end  -->


                            </div>
                        </div>
                    </div>

                </div> <!-- col 1  -->


            </div> <!-- Row 1  -->





        </div> <!-- layout-container-fluid  -->




    </body>


</html>